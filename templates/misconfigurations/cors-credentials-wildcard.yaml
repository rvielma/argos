id: cors-credentials-wildcard
name: "CORS With Credentials and Origin Reflection"
severity: high
description: "CORS is configured to reflect the Origin header while allowing credentials, enabling cross-site data theft through any attacker-controlled domain."
reference: CWE-942
requests:
  - method: GET
    path: "/"
    headers:
      Origin: "https://evil.attacker.com"
    matchers:
      - type: header
        header: "access-control-allow-origin"
        words:
          - "evil.attacker.com"
      - type: header
        header: "access-control-allow-credentials"
        words:
          - "true"
    condition: and
