id: rails-credentials-exposed
name: "Rails Credentials File Exposed"
severity: critical
description: "Rails encrypted credentials or master key file is publicly accessible, allowing decryption of application secrets."
reference: CWE-540
requests:
  - method: GET
    path: "/config/credentials.yml.enc"
    matchers:
      - type: body
        regex:
          - "[A-Za-z0-9+/=]{32,}"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/config/master.key"
    matchers:
      - type: body
        regex:
          - "^[0-9a-f]{32}$"
      - type: status
        status: [200]
    condition: and
