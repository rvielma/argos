id: k8s-service-account-token
name: "Kubernetes Service Account Token Exposed"
severity: critical
description: "Kubernetes service account token is accessible via the web, allowing authentication to the cluster API and potential container escape."
reference: CWE-540
requests:
  - method: GET
    path: "/var/run/secrets/kubernetes.io/serviceaccount/token"
    matchers:
      - type: body
        regex:
          - "^eyJ[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+"
      - type: status
        status: [200]
    condition: and
