id: default-login-nomad
name: "Nomad UI Default Access"
severity: high
confidence: tentative
description: "HashiCorp Nomad UI and API are accessible without ACL tokens, exposing job orchestration, cluster topology, and workload scheduling controls."
reference: CWE-798
requests:
  - method: GET
    path: "/ui/"
    matchers:
      - type: body
        words:
          - "Nomad"
          - "nomad"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/v1/agent/members"
    matchers:
      - type: body
        words:
          - "Members"
          - "Name"
          - "Addr"
          - "Status"
      - type: status
        status: [200]
      - type: header
        header: "content-type"
        words:
          - "application/json"
    condition: and
