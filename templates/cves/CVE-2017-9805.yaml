id: CVE-2017-9805
name: "Apache Struts2 REST Plugin XStream RCE"
severity: critical
description: "Apache Struts2 REST plugin with XStream handler allows remote code execution via crafted XML payload."
reference: CWE-502
confidence: tentative
requests:
  - method: GET
    path: "/"
    matchers:
      - type: body
        words:
          - "Struts"
      - type: status
        status: [200]
    condition: and
  - method: POST
    path: "/struts2-rest-showcase/orders/3"
    headers:
      Content-Type: "application/xml"
    body: "<map><entry><jdk.nashorn.internal.objects.NativeString><flags>0</flags></jdk.nashorn.internal.objects.NativeString></entry></map>"
    matchers:
      - type: body
        words:
          - "Internal Server Error"
          - "exception"
      - type: status
        status: [500]
    condition: and
