id: CVE-2021-26855
name: "Microsoft Exchange ProxyLogon SSRF"
severity: critical
description: "Microsoft Exchange Server SSRF vulnerability allowing unauthenticated attackers to access mailboxes."
reference: CWE-918
requests:
  - method: GET
    path: "/owa/auth/x.js"
    matchers:
      - type: status
        status: [200, 302, 401]
      - type: header
        header: "x-owa-version"
        words:
          - "15."
    condition: and
  - method: GET
    path: "/ecp/default.flt"
    matchers:
      - type: status
        status: [200]
      - type: header
        header: "x-owa-version"
        words:
          - "15."
    condition: and
  - method: GET
    path: "/autodiscover/autodiscover.json?@test.com/owa/?&Email=autodiscover/autodiscover.json%3F@test.com"
    matchers:
      - type: status
        status: [200, 302]
      - type: body
        words:
          - "Microsoft"
          - "Exchange"
      - type: header
        header: "x-owa-version"
        words:
          - "15."
    condition: and
