id: CVE-2021-25281
name: "SaltStack Salt API Unauthenticated Access"
severity: critical
description: "SaltStack Salt before 3002.5 allows unauthenticated access to the Salt API via the salt-api service, enabling remote command execution."
reference: CWE-287
confidence: confirmed
requests:
  - method: GET
    path: "/"
    matchers:
      - type: body
        words:
          - "salt"
          - "Salt"
      - type: status
        status: [200]
    condition: and
  - method: POST
    path: "/run"
    headers:
      Content-Type: "application/json"
    body: '{"client":"runner","fun":"manage.status"}'
    matchers:
      - type: body
        words:
          - "return"
          - "salt"
      - type: status
        status: [200, 401]
    condition: and
