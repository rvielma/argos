id: CVE-2024-1086
name: "OPNsense Privilege Escalation Detection"
severity: high
description: "OPNsense firewall running on affected Linux kernels with nf_tables may be vulnerable to local privilege escalation via netfilter use-after-free."
reference: CWE-416
confidence: informational
requests:
  - method: GET
    path: "/"
    matchers:
      - type: body
        words:
          - "OPNsense"
          - "login"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/api/core/firmware/status"
    matchers:
      - type: body
        words:
          - "product_version"
          - "product_name"
      - type: status
        status: [200, 401]
    condition: and
