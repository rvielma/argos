id: CVE-2023-49070
name: "Apache OFBiz Pre-Auth RCE via XML-RPC"
severity: critical
description: "Apache OFBiz before 18.12.10 allows pre-authentication remote code execution via the deprecated XML-RPC component."
reference: CWE-502
confidence: confirmed
requests:
  - method: GET
    path: "/webtools/control/main"
    matchers:
      - type: body
        words:
          - "OFBiz"
          - "webtools"
      - type: status
        status: [200]
    condition: and
  - method: POST
    path: "/webtools/control/xmlrpc;jsessionid=x"
    headers:
      Content-Type: "application/xml"
    body: '<?xml version="1.0"?><methodCall><methodName>ping</methodName><params><param><value>test</value></param></params></methodCall>'
    matchers:
      - type: body
        words:
          - "methodResponse"
      - type: status
        status: [200]
    condition: and
