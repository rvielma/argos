id: CVE-2024-22234
name: "Spring Security Broken Access Control with AuthenticationTrustResolver"
severity: high
description: "Spring Security 6.1.x before 6.1.7 and 6.2.x before 6.2.2 allows broken access control when AuthenticatedVoter#vote passes a null Authentication to AuthenticationTrustResolver."
reference: CWE-284
confidence: tentative
requests:
  - method: GET
    path: "/actuator/env"
    matchers:
      - type: body
        words:
          - "propertySources"
          - "spring.security"
      - type: status
        status: [200]
    condition: and
