id: CVE-2023-41892
name: "Craft CMS Unauthenticated RCE"
severity: critical
description: "Craft CMS 4.0.0 through 4.4.14 allows unauthenticated remote code execution via the cpresources action with crafted PHP object injection."
reference: CWE-94
confidence: confirmed
requests:
  - method: GET
    path: "/"
    matchers:
      - type: header
        words:
          - "craft"
        header: "X-Powered-By"
      - type: body
        words:
          - "craft"
    condition: or
  - method: POST
    path: "/index.php"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    body: "action=conditions/render&configObject[class]=craft\\elements\\conditions\\ElementCondition"
    matchers:
      - type: body
        words:
          - "Craft CMS"
          - "condition"
      - type: status
        status: [200, 400]
    condition: and
