id: CVE-2022-22720
name: "Apache HTTP Server Request Smuggling"
severity: high
description: "Apache HTTP Server 2.4.52 and earlier fails to close inbound connection when errors are encountered discarding the request body, leading to HTTP request smuggling."
reference: CWE-444
confidence: tentative
requests:
  - method: GET
    path: "/"
    matchers:
      - type: header
        words:
          - "Apache"
        header: "Server"
      - type: body
        words:
          - "Apache"
    condition: and
  - method: GET
    path: "/server-status"
    matchers:
      - type: body
        words:
          - "Apache Server Status"
          - "Server Version"
      - type: status
        status: [200]
    condition: and
