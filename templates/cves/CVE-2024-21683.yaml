id: CVE-2024-21683
name: "Confluence RCE via Code Macro"
severity: high
description: "Atlassian Confluence Data Center and Server allow authenticated attackers to execute arbitrary code via injection in custom code macros."
reference: CWE-94
confidence: tentative
requests:
  - method: GET
    path: "/"
    matchers:
      - type: body
        words:
          - "Confluence"
          - "Atlassian"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/rest/api/space"
    matchers:
      - type: body
        words:
          - "results"
          - "space"
      - type: status
        status: [200]
    condition: and
