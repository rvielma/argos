id: CVE-2023-38646
name: "Metabase Pre-Auth Remote Code Execution"
severity: critical
description: "Metabase open source before 0.46.6.1 and enterprise before 1.46.6.1 allows unauthenticated RCE via a specially crafted /api/setup/validate request."
reference: CWE-94
confidence: confirmed
requests:
  - method: GET
    path: "/api/session/properties"
    matchers:
      - type: body
        words:
          - "setup-token"
          - "version"
      - type: status
        status: [200]
    condition: and
  - method: POST
    path: "/api/setup/validate"
    headers:
      Content-Type: "application/json"
    body: '{"token":"test","details":{"engine":"h2","details":{"db":"test","advanced-options":false}}}'
    matchers:
      - type: body
        words:
          - "token"
      - type: status
        status: [200, 400]
    condition: and
