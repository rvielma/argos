id: CVE-2021-21311
name: "Adminer SSRF via Elasticsearch Driver"
severity: high
description: "Adminer 4.0.0 to 4.7.9 allows SSRF via the Elasticsearch driver, enabling an attacker to make server-side requests to arbitrary hosts."
reference: CWE-918
confidence: confirmed
requests:
  - method: GET
    path: "/adminer.php"
    matchers:
      - type: body
        words:
          - "adminer"
          - "Login"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/adminer.php?elastic=localhost&username="
    matchers:
      - type: body
        words:
          - "adminer"
          - "elastic"
      - type: status
        status: [200]
    condition: and
