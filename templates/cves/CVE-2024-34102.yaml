id: CVE-2024-34102
name: "Adobe Commerce CosmicSting XXE to RCE"
severity: critical
description: "Adobe Commerce and Magento Open Source allow unauthenticated XXE via the CMS REST API, leading to remote code execution (CosmicSting)."
reference: CWE-611
confidence: confirmed
requests:
  - method: GET
    path: "/magento_version"
    matchers:
      - type: body
        words:
          - "Magento"
      - type: status
        status: [200]
    condition: and
  - method: POST
    path: "/rest/all/V1/guest-carts/test/estimate-shipping-methods"
    headers:
      Content-Type: "application/json"
    body: '{"address":{"firstname":"test"}}'
    matchers:
      - type: body
        words:
          - "carrier_code"
      - type: status
        status: [200, 400]
    condition: and
