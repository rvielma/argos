id: CVE-2020-13942
name: "Apache Unomi Remote Code Execution"
severity: critical
description: "Apache Unomi before 1.5.2 allows remote code execution via OGNL and MVEL expression injection through the /context.json and /eventcollector endpoints."
reference: CWE-94
confidence: confirmed
requests:
  - method: POST
    path: "/context.json"
    headers:
      Content-Type: "application/json"
    body: '{"personalizations":[{"id":"test","strategy":"matching-first","strategyOptions":{"fallback":"var2"},"contents":[{"filters":[{"condition":{"parameterValues":{"propertyName":"prop","comparisonOperator":"equals","propertyValue":"test"},"type":"profilePropertyCondition"},"properties":{}}]}]}],"sessionId":"test"}'
    matchers:
      - type: body
        words:
          - "profileId"
          - "sessionId"
      - type: status
        status: [200]
    condition: and
