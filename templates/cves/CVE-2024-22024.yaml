id: CVE-2024-22024
name: "Ivanti Connect Secure XXE"
severity: high
description: "Ivanti Connect Secure, Policy Secure, and ZTA gateways contain an XML external entity vulnerability in the SAML component allowing unauthenticated access to restricted resources."
reference: CWE-611
confidence: tentative
requests:
  - method: GET
    path: "/dana-na/auth/url_default/welcome.cgi"
    matchers:
      - type: body
        words:
          - "Pulse Secure"
          - "welcome"
      - type: status
        status: [200]
    condition: and
  - method: POST
    path: "/dana-ws/saml.ws"
    headers:
      Content-Type: "text/xml"
    body: '<?xml version="1.0"?><samlp:Response xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" ID="argos" />'
    matchers:
      - type: body
        words:
          - "saml"
      - type: status
        status: [200, 400, 500]
    condition: and
