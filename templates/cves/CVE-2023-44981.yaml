id: CVE-2023-44981
name: "Apache ZooKeeper SASL Auth Bypass"
severity: critical
description: "Apache ZooKeeper contains an authorization bypass vulnerability where SASL quorum peer authentication can be bypassed by a bad actor who can create a server with a matching instance part."
reference: CWE-639
confidence: tentative
requests:
  - method: GET
    path: "/commands"
    matchers:
      - type: body
        words:
          - "configuration"
          - "connections"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/commands/stat"
    matchers:
      - type: body
        words:
          - "version"
          - "server_state"
      - type: status
        status: [200]
    condition: and
