id: CVE-2023-3128
name: "Grafana Auth Bypass via Azure AD"
severity: critical
description: "Grafana contains an authentication bypass vulnerability where Azure AD OAuth can be exploited due to email verification not being enforced, allowing account takeover."
reference: CWE-290
confidence: tentative
requests:
  - method: GET
    path: "/login"
    matchers:
      - type: body
        words:
          - "Grafana"
          - "grafana"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/api/health"
    matchers:
      - type: body
        words:
          - "database"
          - "ok"
      - type: status
        status: [200]
    condition: and
