id: CVE-2020-9496
name: "Apache OFBiz XML-RPC Deserialization RCE"
severity: critical
description: "Apache OFBiz before 17.12.04 allows remote code execution via unsafe deserialization in XML-RPC requests to /webtools/control/xmlrpc."
reference: CWE-502
confidence: confirmed
requests:
  - method: GET
    path: "/webtools/control/main"
    matchers:
      - type: body
        words:
          - "OFBiz"
          - "Apache"
      - type: status
        status: [200]
    condition: and
  - method: POST
    path: "/webtools/control/xmlrpc"
    headers:
      Content-Type: "application/xml"
    body: '<?xml version="1.0"?><methodCall><methodName>ping</methodName><params><param><value>test</value></param></params></methodCall>'
    matchers:
      - type: body
        words:
          - "methodResponse"
          - "faultCode"
      - type: status
        status: [200]
    condition: and
