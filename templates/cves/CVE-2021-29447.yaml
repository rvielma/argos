id: CVE-2021-29447
name: "WordPress XXE via Media Library"
severity: high
description: "WordPress 5.6 through 5.7 allows XXE attacks via the media library when processing WAV files with PHP 8."
reference: CWE-611
confidence: tentative
requests:
  - method: GET
    path: "/wp-login.php"
    matchers:
      - type: body
        words:
          - "wp-login"
          - "user_login"
          - "user_pass"
      - type: status
        status: [200]
    condition: and
    extractors:
      - type: regex
        name: version
        regex: "WordPress\\s+(\\d+\\.\\d+\\.?\\d*)"
        group: 1
  - method: GET
    path: "/readme.html"
    matchers:
      - type: body
        words:
          - "WordPress"
          - "Version"
      - type: status
        status: [200]
      - type: version
        variable: version
        version_range: ">= 5.6 < 5.8"
    condition: and
