id: CVE-2024-4040
name: "CrushFTP VFS Sandbox Escape"
severity: critical
description: "CrushFTP contains a server-side template injection vulnerability in the VFS sandbox allowing unauthenticated attackers to escape the virtual filesystem and read arbitrary files."
reference: CWE-94
confidence: tentative
requests:
  - method: GET
    path: "/WebInterface/login.html"
    matchers:
      - type: body
        words:
          - "CrushFTP"
          - "login"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/WebInterface/function/?command=getUserList&c2f=argos"
    matchers:
      - type: body
        words:
          - "CrushFTP"
      - type: status
        status: [200, 403]
    condition: and
