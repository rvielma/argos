id: CVE-2024-9264
name: "Grafana SQL Expressions RCE"
severity: critical
description: "Grafana allows authenticated users to execute arbitrary SQL expressions via DuckDB, leading to local file read and remote code execution if DuckDB is installed."
reference: CWE-94
confidence: tentative
requests:
  - method: GET
    path: "/login"
    matchers:
      - type: body
        words:
          - "Grafana"
          - "grafana"
      - type: status
        status: [200]
    condition: and
  - method: GET
    path: "/api/frontend/settings"
    matchers:
      - type: body
        words:
          - "sqlExpressions"
          - "datasources"
      - type: status
        status: [200]
    condition: and
