<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Argos Panoptes - Security Scan Report</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: #f8fafc; color: #1e293b; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); color: white; padding: 40px 0; margin-bottom: 30px; }
        header .container { display: flex; align-items: center; gap: 20px; }
        .trident { font-size: 48px; }
        header h1 { font-size: 28px; font-weight: 700; letter-spacing: 2px; }
        header p { color: #94a3b8; font-size: 14px; margin-top: 4px; }
        .meta-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 30px; }
        .meta-card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .meta-card label { font-size: 12px; text-transform: uppercase; color: #64748b; font-weight: 600; letter-spacing: 1px; }
        .meta-card .value { font-size: 18px; font-weight: 700; margin-top: 4px; color: #0f172a; }
        .section { background: white; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 24px; overflow: hidden; }
        .section-header { padding: 20px 24px; border-bottom: 1px solid #e2e8f0; font-size: 18px; font-weight: 700; }
        .section-body { padding: 24px; }
        .severity-bars { display: flex; flex-direction: column; gap: 12px; }
        .severity-row { display: flex; align-items: center; gap: 12px; }
        .severity-label { width: 80px; font-size: 13px; font-weight: 600; text-transform: uppercase; }
        .severity-bar-bg { flex: 1; height: 28px; background: #f1f5f9; border-radius: 4px; overflow: hidden; position: relative; }
        .severity-bar-fill { height: 100%; border-radius: 4px; transition: width 0.3s; display: flex; align-items: center; padding-left: 10px; color: white; font-size: 13px; font-weight: 600; min-width: fit-content; }
        .severity-bar-fill.critical { background: #dc2626; }
        .severity-bar-fill.high { background: #ea580c; }
        .severity-bar-fill.medium { background: #ca8a04; }
        .severity-bar-fill.low { background: #2563eb; }
        .severity-bar-fill.info { background: #6b7280; }
        .severity-count { width: 40px; text-align: right; font-weight: 700; font-size: 16px; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #f8fafc; text-align: left; padding: 12px 16px; font-size: 12px; text-transform: uppercase; color: #64748b; font-weight: 600; letter-spacing: 1px; border-bottom: 2px solid #e2e8f0; }
        td { padding: 12px 16px; border-bottom: 1px solid #f1f5f9; font-size: 14px; }
        tr:hover { background: #f8fafc; }
        .badge { display: inline-block; padding: 2px 10px; border-radius: 12px; font-size: 12px; font-weight: 600; text-transform: uppercase; color: white; }
        .badge-critical { background: #dc2626; }
        .badge-high { background: #ea580c; }
        .badge-medium { background: #ca8a04; }
        .badge-low { background: #2563eb; }
        .badge-info { background: #6b7280; }
        .finding-detail { border: 1px solid #e2e8f0; border-radius: 8px; margin-bottom: 20px; overflow: hidden; }
        .finding-detail-header { padding: 16px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #e2e8f0; background: #f8fafc; }
        .finding-detail-header h3 { font-size: 16px; font-weight: 600; }
        .finding-detail-body { padding: 20px; }
        .finding-detail-body .field { margin-bottom: 16px; }
        .finding-detail-body .field-label { font-size: 12px; text-transform: uppercase; color: #64748b; font-weight: 600; letter-spacing: 1px; margin-bottom: 4px; }
        .finding-detail-body .field-value { font-size: 14px; }
        .code-block { background: #1e293b; color: #e2e8f0; padding: 16px; border-radius: 6px; font-family: "Fira Code", "Cascadia Code", monospace; font-size: 13px; overflow-x: auto; white-space: pre-wrap; word-break: break-all; }
        .tags { display: flex; gap: 8px; flex-wrap: wrap; }
        .tag { display: inline-block; padding: 2px 8px; background: #f1f5f9; border-radius: 4px; font-size: 12px; color: #475569; }
        footer { text-align: center; padding: 30px; color: #94a3b8; font-size: 13px; }
        @media (max-width: 768px) {
            .meta-grid { grid-template-columns: 1fr 1fr; }
            header .container { flex-direction: column; text-align: center; }
            table { font-size: 13px; }
            td, th { padding: 8px 10px; }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="trident">&#x1F531;</div>
            <div>
                <h1>ARGOS PANOPTES</h1>
                <p>Security Vulnerability Assessment Report</p>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="meta-grid">
            <div class="meta-card">
                <label>Target</label>
                <div class="value">{{ target }}</div>
            </div>
            <div class="meta-card">
                <label>Scan ID</label>
                <div class="value">{{ scan_id }}</div>
            </div>
            <div class="meta-card">
                <label>Started</label>
                <div class="value">{{ started_at }}</div>
            </div>
            <div class="meta-card">
                <label>Finished</label>
                <div class="value">{{ finished_at }}</div>
            </div>
            <div class="meta-card">
                <label>Total Requests</label>
                <div class="value">{{ total_requests }}</div>
            </div>
            <div class="meta-card">
                <label>Total Findings</label>
                <div class="value">{{ total_findings }}</div>
            </div>
            <div class="meta-card">
                <label>Modules Executed</label>
                <div class="value">{{ modules_executed }}</div>
            </div>
        </div>

        <div class="section">
            <div class="section-header">Executive Summary</div>
            <div class="section-body">
                <div class="severity-bars">
                    <div class="severity-row">
                        <span class="severity-label" style="color:#dc2626;">Critical</span>
                        <div class="severity-bar-bg">
                            {% if total_findings > 0 %}<div class="severity-bar-fill critical" style="width: {{ critical_count * 100 / total_findings }}%;">{{ critical_count }}</div>{% endif %}
                        </div>
                        <span class="severity-count">{{ critical_count }}</span>
                    </div>
                    <div class="severity-row">
                        <span class="severity-label" style="color:#ea580c;">High</span>
                        <div class="severity-bar-bg">
                            {% if total_findings > 0 %}<div class="severity-bar-fill high" style="width: {{ high_count * 100 / total_findings }}%;">{{ high_count }}</div>{% endif %}
                        </div>
                        <span class="severity-count">{{ high_count }}</span>
                    </div>
                    <div class="severity-row">
                        <span class="severity-label" style="color:#ca8a04;">Medium</span>
                        <div class="severity-bar-bg">
                            {% if total_findings > 0 %}<div class="severity-bar-fill medium" style="width: {{ medium_count * 100 / total_findings }}%;">{{ medium_count }}</div>{% endif %}
                        </div>
                        <span class="severity-count">{{ medium_count }}</span>
                    </div>
                    <div class="severity-row">
                        <span class="severity-label" style="color:#2563eb;">Low</span>
                        <div class="severity-bar-bg">
                            {% if total_findings > 0 %}<div class="severity-bar-fill low" style="width: {{ low_count * 100 / total_findings }}%;">{{ low_count }}</div>{% endif %}
                        </div>
                        <span class="severity-count">{{ low_count }}</span>
                    </div>
                    <div class="severity-row">
                        <span class="severity-label" style="color:#6b7280;">Info</span>
                        <div class="severity-bar-bg">
                            {% if total_findings > 0 %}<div class="severity-bar-fill info" style="width: {{ info_count * 100 / total_findings }}%;">{{ info_count }}</div>{% endif %}
                        </div>
                        <span class="severity-count">{{ info_count }}</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-header">Findings Overview</div>
            <div class="section-body" style="padding: 0;">
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Severity</th>
                            <th>Title</th>
                            <th>Category</th>
                            <th>URL</th>
                            <th>CWE</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for finding in findings %}
                        <tr>
                            <td>{{ loop.index }}</td>
                            <td>
                                {% if finding.severity == "Critical" %}<span class="badge badge-critical">Critical</span>
                                {% elif finding.severity == "High" %}<span class="badge badge-high">High</span>
                                {% elif finding.severity == "Medium" %}<span class="badge badge-medium">Medium</span>
                                {% elif finding.severity == "Low" %}<span class="badge badge-low">Low</span>
                                {% else %}<span class="badge badge-info">Info</span>{% endif %}
                            </td>
                            <td><a href="#finding-{{ loop.index }}">{{ finding.title }}</a></td>
                            <td><span class="tag">{{ finding.category }}</span></td>
                            <td style="max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">{{ finding.url }}</td>
                            <td>{% if finding.cwe_id %}CWE-{{ finding.cwe_id }}{% endif %}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <div class="section">
            <div class="section-header">Detailed Findings</div>
            <div class="section-body">
                {% for finding in findings %}
                <div class="finding-detail" id="finding-{{ loop.index }}">
                    <div class="finding-detail-header">
                        <h3>{{ loop.index }}. {{ finding.title }}</h3>
                        {% if finding.severity == "Critical" %}<span class="badge badge-critical">Critical</span>
                        {% elif finding.severity == "High" %}<span class="badge badge-high">High</span>
                        {% elif finding.severity == "Medium" %}<span class="badge badge-medium">Medium</span>
                        {% elif finding.severity == "Low" %}<span class="badge badge-low">Low</span>
                        {% else %}<span class="badge badge-info">Info</span>{% endif %}
                    </div>
                    <div class="finding-detail-body">
                        <div class="field">
                            <div class="field-label">URL</div>
                            <div class="field-value">{{ finding.url }}</div>
                        </div>
                        <div class="field">
                            <div class="field-label">Description</div>
                            <div class="field-value">{{ finding.description }}</div>
                        </div>
                        <div class="tags">
                            <span class="tag">{{ finding.category }}</span>
                            {% if finding.cwe_id %}<span class="tag">CWE-{{ finding.cwe_id }}</span>{% endif %}
                            {% if finding.owasp_category %}<span class="tag">{{ finding.owasp_category }}</span>{% endif %}
                        </div>
                        {% if finding.evidence %}
                        <div class="field" style="margin-top:16px;">
                            <div class="field-label">Evidence</div>
                            <div class="code-block">{{ finding.evidence }}</div>
                        </div>
                        {% endif %}
                        {% if finding.request %}
                        <div class="field">
                            <div class="field-label">Request</div>
                            <div class="code-block">{{ finding.request }}</div>
                        </div>
                        {% endif %}
                        {% if finding.response %}
                        <div class="field">
                            <div class="field-label">Response</div>
                            <div class="code-block">{{ finding.response }}</div>
                        </div>
                        {% endif %}
                        {% if finding.recommendation %}
                        <div class="field">
                            <div class="field-label">Recommendation</div>
                            <div class="field-value">{{ finding.recommendation }}</div>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <footer>
        <p>Generated by Argos Panoptes Security Scanner | Scan ID: {{ scan_id }}</p>
        <p>This report is confidential and intended for authorized personnel only.</p>
    </footer>
</body>
</html>
